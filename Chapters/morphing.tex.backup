% Chapter Template

\chapter{Morphing of Local Statistics: Mapping Ensembles through a Resolution Bottleneck} % Main chapter title

Top-Down coarse-grained models aim at reproducing certain experimentally observed phenomenas or to study the consequences upon application of general rules. As such, top-down coarse-grained models are typically not chemically specific. However, in many cases the coarse-grained model incorporates both philosophies, i.e. bottom-up and top-down aspects. Examples of such hybrid models include the Martini forcefield, where a structure-based method is used to tune bonded interactions, and the KG polymer model with a tuned bending potential, which allows to establish a relation to real polymers at the Kuhn scale. While those models can be considered as chemically-specific, they lack the structural fidelity of solely structure-based coarse-grained models. This issue becomes especially apparent when the ensemble of the coarse-grained model is compared with an ensemble of an higher resolution model of the specific system mapped to the coarse-grained resolution. 

In this chapter, a method to improve the quality of molecular structures obtained with hybrid top-down models is investigated. In particular, the method aims at morphing local statistics in order to resemble a given target distribution more closely. To this end, a local scale is introduced that defines the extent to which features are allowed to change. Specifically, molecular structures of an initial distribution are further coarse-grained up to this scale. Afterwards, DBM is applied to reintroduce local features learned from examples of the target system. 

The motivation for this project is to introduce a two-step backmapping scheme for hybrid top-down coarse-grained models. Backmapping of imperfect molecular structures is expected to yield unphysical artifacts. In order to reduce such artifacts already on the coarse-grained scale, local statistics of the coarse-grained structure are corrected before serving it as an input for the backmapping algorithm. 

In the following, the method is applied to two systems: (1) A condensed-phase system of the alkene tetracosane sampled with the Martini forcefield and (2) a polymer melt of sPS sampled with the KG moldel with additional bending potential. The content presented in this chapter is not published yet.

\label{morphing} % Change X to a consecutive number; for referencing this chapter elsewhere, use \ref{ChapterX}

\begin{figure}
  \centering
      \includegraphics[width=1.0\textwidth]{./Figures/morphing/intro2.png}
  \caption{morphbm}
  \label{FIG:TET_morphbm}
\end{figure}


\section{Method}

The method applied in this chapter aims at morphing local features of molecular structures by passing them through a resolution bottleneck. The idea is inspired by the concept of cross-modal learning (CML) known in the ML community.\cite{feng2014cross, cao2016correlation, mukherjee2017deep, yoo2019image} CML is used to link sources of information from different domains, such as audio-to-image translation. In its core, two autoencoder $A$ and $B$ are trained to encode and decode samples $\mathbf{a}$ and $\mathbf{b}$ from two different distributions $\mathcal{A}$ and $\mathcal{B}$. Cross-connecting the encoder $e$ and decoder $d$ of both models, i.e. $d_B\big(e_A(\mathbf{a})\big)$ and $d_A\big(e_B(\mathbf{b})\big)$ respectively, aims at mapping between the distributions $\mathcal{A}$ and $\mathcal{B}$. However, connecting the latent distribtions of both models, i.e. the information-bottleneck, is challenging and subject to current research.\cite{wang2016comprehensive}

Here, two distributions of molecular structures $\mathcal{X}$ and $\mathcal{Y}$ are given, where the resolution of both distributions is equivalent. While the ultimate goal is to introduce a ML based mapping function $g_{\Theta}$ from one distribution to the other, i.e. $g_{\Theta}(\mathcal{X}) \approx \mathcal{Y}$, it is investigated if such a mapping can be realized by changing features only on a local scale. In other words, it is hypothesized that both distributions match at a lower resolution. To this end, a simple encoder $e_s$, i.e. a fine-to-coarse mapping of the coordinates, is chosen that reduces the number of particles $n$ by a factor $s$

\begin{equation}
 e_{s}: \mathbb{R}^{3n} \rightarrow \mathbb{R}^{3n/s} .
\end{equation}

Specifically, $e_n$ computes the center of mass for groups of $n$ particles. Afterwards, the coarse-grained structure is backmapped utilizing DBM as explained in Sec. \ref{methology}. Importantly, DBM is trained solely on structures drawn from the target distribution $\mathcal{Y}$ but deployed for coarse-grained structures drawn from the input distribution $\mathcal{X}$. As such, local features removed by $e_s$ are reinserted based on the local correlations learned from $\mathcal{Y}$. 

Deploying different values for the coarse-graining factor $s$ allows to scale the extent to which local features are allowed to change. Assuming that the backmapping scheme yields a perfect reconstruction, the mapping $g_{\Theta}(e_s(\mathcal{X}))$ is expected to yield a more accurate reproduction of $\mathcal{Y}$ the larger $s$ becomes, since the reinsertion of details becomes less restricted by the coarse-grained representation. However, larger values of $s$ lead to a more complex backmapping excercise. As such, chosing the value for $s$ is a trade-off between the complexity of the backmapping task and the impact of the morphing. 

The proposed method is solely data driven, i.e it avoids to parametrize a forcefield for the given target distribution. However, the quality of morphed structures can be improved by incorporating an artificial energy landscape that penalizes forbitten configurations in terms of bond lengths, angles and non-bonded distances. In particular, a harmonic potential of the form

\begin{equation}
 U(s) =
  \begin{cases}
      a(s - s_{\text{min}})^2,& s < s_{\text{min}}\\
      a(s - s_{\text{max}})^2,& s > s_{\text{max}}\\
      0,              & \text{otherwise},
  \end{cases}
\end{equation}

is applied as bonded interaction, where $s$ represents bond lengths and angles, respectively, and $a$ is a scaling factor.  Similarly, a harmonic potential for non-bonded distances $d$

\begin{equation}
 U(d) =
  \begin{cases}
      a(1 - \frac{d}{d_{\text{min}}})^2,& d < d_{\text{min}}\\
      0,              & \text{otherwise},
  \end{cases}
\end{equation}

is introduced, where $d_{\text{min}}$ is the minimum distance for non-bonded particles. The values for the minimum and maximum distances/angles are obtained from distributions of the target system.

\section{Kremer-Grest Model: Syndiotactic Polystyrene}

The Kremer-Grest (KG) model is a standart model for computer simulations of polymeric systems. It is designed to study generic polymer properties with an emphasise on computational efficiency and simplicity. As outlined in Sec. \ref{}, the KG model is a bead-spring model, where consecutive beads are connected via strong nonlinear springs, i.e. the FENE potential (Eq. \ref{}), and mutual interactions between all beads are modeled via a truncated Lennard-Jones potential (Eq. \ref{}). The deployed interaction potentials aim at reproducing topological contraints of real polymeric systems, i.e. chain backbones are prohibitted to pass through each other. As such, the KG model is able to yield large scale entanglement properties that are characteristic for long-chain polymers. In order to modify the stiffness of the polymer chains, an additional bending potential can be introduced (Eq. \ref{}) scaled by the prefactor $\kappa$.

\subsection{Matching at the Kuhn Scale}

An important characteristic of many polymeric systems is their universal large-scale behavior that manifests in scaling relations. Specifically, the mean square end-to-end distance $\langle R^2_e \rangle$ of a polymer chain scales with the number of beads $N$, i.e. $\langle R^2_e \rangle \propto N^{2\nu}$. In a melt state, polymers adopt the characteristics of a random-walk and $\nu = \frac{1}{2}$. However, local interactions of real polymers introduce correlations between monomers that ultimately increase $\langle R^2_e \rangle$. In order to account for such correlations, the results known for ideal chains, i.e. the random-walk behavior $\langle R^2_e \rangle = l^2 N$, requires a correction

\begin{equation}
  \langle R^2_e \rangle = C_{\infty} l^2 N ,
\end{equation}

where $l$ is the bond length between consecutive monomers and $C_{\infty}$ is Flory's characteristic ratio. Note that $C_{\infty}$ depends on the local stiffness of the polymer chain. As such, emergend large-scale properties are influenced by microscopic details.

The crossover from local, chemistry specific to universal, random-walk behavior is characterized by the Kuhn length $b$. It is defined by mapping the real chain onto an equivalent ideal chain with $n$ segments of length $b$ that reproduces $\langle R^2_e \rangle$ and the contour length $L = N l$, i.e.

\begin{equation}
    \langle R^2_e \rangle =  b^2 n ,
\end{equation}

\begin{equation}
    L = nb .
\end{equation}

A key parameter to characterize a specific polymer chemistry is the Kuhn number $n_k$. It is a dimensionless parameter, which defines the number of Kuhn segments within a cube of length $b$,

\begin{equation}
\label{kuhn_number}
  n_k = \rho_k b^3 ,
\end{equation}

where $\rho_k$ is the number density of Kuhn segments. It is observed that $n_k$ systematically correlates with emergend properties such as the entanglement length.\cite{}. As such, $n_k$ allows to link experimentally observed commodity polymers with model polymer melts.

While the Kuhn number $n_k$ is material specific and depends on atomic details it is not straight forward to infer its dependence on the deployed interaction potentials. However, Everes et. al have found a direct relation between the chain stiffness $\kappa$ of the KG model and the implied Kuhn number $n_k$,

\begin{equation}
  b(\kappa) = b^{(0)} + \Delta b ,
\end{equation}

\begin{equation}
  \Delta b = 0.77 \sigma (\text{tanh}(-.03\kappa^2 - 0.41 \kappa + 0.16) + 1),
\end{equation}

where $b^{(0)}$ is the bare Kuhn length in the absence of excluded volume interactions and $sigma$ is the bead diameter. Given the Kuhn length $b$ it is straight forward to infer to corresponding Kuhn number $n_k$ from Eq. \ref{kuhn_number}. 

In summary, the KG model with additional bending potential offers a one parameter model that covers a wide range of experimentally relevant commodity polymers. Such Kuhn scale matched model polymers can be regarded as a special case of structure-based coarse-graining. Controlling the Kuhn number with the parameter for the chain stiffness $\kappa$ allows to reproduce emergent universal large length and time scale behavior. However, this remarkable simple model only allows to retain the behavior above the Kuhn scale, whereas particular properties below the Kuhn scale, i.e. local properties, are not expected to resemble the target system. Specifically, solely structure-based coarse-grained models on a similar level of resolution are presumed to yield a locally more faithful representation.

\subsection{Set-up and Reference Data}

To underpin the above statement, the moderately coarse-grained model for syndiotactic polystyrene by Fritz \emph{et al.} is considered, which is already discussed in Sec. \ref{SEC:sPS}. The model, which will be referred to as \textit{Fritz} model is the following, is parametrized based on detailed all-atom simulations of stereoregular PS sequences in vacuum and reproduces the target thermodynamic properties with remarkable accuracy.\cite{fritz2009coarse} A simulation of the Fritz forcefield is carried out in the NPT ensemble at $T = 496$K using the molecular dynamics package GROMACS 5.0.\cite{hess2008gromacs} Temperature and pressure of the system are controlled using the velocity rescaling thermostat and the Parrinello-Rahman barostat. An integration timestep of $1$ fs is used and samples are recorded every $2.5$ns. The simulation box contains 24 molecules consisting of 96 monomers each. In order to compare thermodynamic properties of the Fritz model and KG model, the former is mapped onto the resolution of the KG model. Following \cite{}, three polystyrene monomers are mapped onto a single KG bead, which is positioned according to the center of mass of the corresponding monomers. 

Snapshots of the KG model with an equivalent number of polymers and chain size are sampled by an NVT simulation performed with \textit{ESPResSo++}.\cite{} The standard parameters for the KG model are deployed, i.e. the bead density $\rho = 0.85\sigma^{-3}$, the distance at which the FENE potential diverges $R = \sigma$ and the bond length $l = 0.965 \sigma$. Note that the model is athermal since all interaction potentials scale with $k_B T$. While \cite{} only provides values for the stiffness parameter $\kappa$ associated with isotactic and atactic polystyrene, the mean value of both, i.e. $\kappa = 0.8815$, is deployed as an educated guess in this study to model syndiotactic polystyrene. In general, the stiffness parameters listet in \cite{} are only valid in the reference temperature $T = 413$ K. Here, a higher temperature was chosen to sample the Fritz model since sPS undergoes a phase transition from melt to crystalline phase at $T \approx 450$K. However, the authors state that static melt properties are relatively insensitive to changes of temperature.\cite{} The bead diameter is set to $\sigma = 1.0$ throughout the simulation, but distances are rescaled in order to match the particle density of the Fritz model. 

\subsection{Results}

Morphing of the local statistics for snapshots obtained with the KG model is performed for $s = 2,4,6$. The training set for DBM consists of 22 snapshots obtained with the Fritz model. For validation, 500 samples of the KG model are morphed deploying both schemes outlined in \ref{}. As a reference, 500 samples of the Fritz model are used.

\subsubsection{Large-scale Characteristics}

Table \ref{TAB:morph_sps_large_scale} summarizes large-scale properties, such as the mean square end-to-end distance $\langle R^2_e \rangle$, radius of gyration $\langle R^2_g \rangle$ and contour length $L$. As expected, the Kuhn scale matched KG model yields similar large-scale characteristics as the Fritz model. The biggest impact upon morphing is observed for $s=6$ in terms of the contour length $L$. However, the overall impact of DBM on the large-scale properties is not significant.

\begin{table}
\begin{tabular}{ c|c|c|c } 
 & $\sqrt{\langle R^2_e \rangle}$ [nm] & $\sqrt{\langle R^2_g \rangle}$ [nm] & $L$ [nm] \\
\hline
Fritz model & 6.06 & 2.51 & 22.92 \\  
KG model & 6.01 & 2.43 & 22.58 \\ 
$s=2$, scheme A & 6.02 & 2.43 & 22.63 \\  
$s=4$, scheme A & 6.05 & 2.43 & 22.36 \\  
$s=6$, scheme A & 6.01 & 2.39 & 20.87 \\  
$s=2$, scheme B & 6.01 & 2.43 & 22.56 \\  
$s=4$, scheme B & 6.00 & 2.44 & 22.53 \\  
$s=6$, scheme B & 6.01 & 2.45 & 21.81 
\caption{Large-scale characteristics of the Fritz model, KG model and morphed structures deploying both morphing schemes A and B with different morphing scales $s = 2,4,6$. }
\label{TAB:morph_sps_large_scale}
\end{tabular}
\end{table}

\subsubsection{Structural Distributions}

The difference between the Fritz and KG model becomes more apparent for local structural features. Fig. \ref{morph_sps_ff_dists} a) and b) display distribution functions for the bond length. While the KG model yields polymers with a sharp bond length distribution that has a peak at $0.72$nm, polymers obtained with the Fritz model display a broader distribution peaked at $0.79$nm. The impact of the morphing on the bond length distribution is mixed and depends on the morphing scale $s$ as well as the applied morhing scheme. The best results deploying morphing scheme A are obtained for $s=2$, where the bond length distribution of the morphed structures match remarkably well with the reference Fritz model. Higher values of $s$ deteriorate the morphing capability for the bond lengths. Regarding scheme B, the best results are obtained for the intermediate morphing scale $s=4$, while $s=2$ has an neglectable impact on the distribution and $s=6$ yields a distribution that is too broad.

The angle distributions shown in Fig. \ref{morph_sps_ff_dists} c) and d) reveal that KG as well as the Fritz model yield polymeric structures that cover a wide range of angles between consecutive bonds. However, the angle distribution for the Fritz model displays a single peak at $\approx 135^{\circ}$, while the distribution for the KG model has two peaks: A major peak at $\approx 130^{\circ}$ and a sidepeak at $\approx 70^{\circ}$. As such, the KG model puts higher statistical weight on small angles $< 100^{\circ}$ compared to the Fritz model. Both morphing schemes are able to suppress small angles for $s=6$. Smaller values of $s$ reduce the impact of the morphing on the angle distribution. Especially, morphing scheme B at $s=2$ has no noticeable impact.

Fig. \ref{morph_sps_ff_dists} e) and f) display the pair correlation $g(r)$ between nonbonded beads. Polymer melts generated with the KG model yield a sharply peaked pair correlation function, while the $g(r)$ for melts obtained with the Fritz model are less peaked and reveal a shorter minimum distance between nonbonded beads. Both morphing schemes smooth the pair correlation of KG structures. The best match with the reference Fritz model is obtained for scheme A and $s=2$.

\begin{figure}[h]
  \centering
      \includegraphics[width=0.8\textwidth]{./Figures/morphing/sPS/morph_ff_dists.pdf}
  \caption{Canonical distributions for sPS at the KG resolution. (a) and (b) bond length distribution, (c) and (d) angle distribution, (e) and (f) radial distribution function $g(r)$. Left: morphing scheme A. Right: Morphing scheme B }
  \label{FIG:morph_sps_ff_dists}
\end{figure}

\subsubsection{Sketch-Map Free Energy}

Further analysis of the chain statistics for the polymer melts is accomplished by a free energy calculation deploying sketch-map coordinates, as shown in Fig \ref{FIG:morph_sps_free_energy}. Similar to the analysis in Sec. \ref{}, local environments $\mathcal{H}$ centered along the polymer beads are constructed and the pairwise distance between two such environemnts is encoded using a similarity kernel $k(\mathcal{H}, \mathcal{H}') = \mathbf{p}(\mathcal{H}) \mathbf{p}(\mathcal{H'})$ based on the normalized many-body SOAP representation $\mathbf{p}(\mathcal{H})$.\cite{bartok2013representing} In order to obtain a global similarity kernel $k(a,b)$ for two polymer chains $a$ and $b$, the covariance matrix $C_{ij}(a,b) = \mathbf{p}(\mathcal{H}^a_i) \mathbf{p}(\mathcal{H}^b_j)$ is mapped to a single scalar value using an average kernel.\cite{de2016comparing} Landmarks for the sketch-map coordinates are obtained for 524 polymer chains sampled from both, the KG as well as the Fritz model. 

Fig. \ref{} displays the free energy landscape expressed in sketch-map coordinates. For each panel, 12000 polymer chains are projected onto the sketch-map space guided by the landmarks. The projections are used to construct a two-dimensional histogram with 50 bins along each dimension. The relative populations $N$ for each bin are then used to compute free energy differences between two states $A$ and $B$ as

\begin{equation}
  \Delta F_{AB} = - k_B T ln (N_A/N_B) .
\end{equation}

The sketch-map free energy landscape obtained for the Fritz model is depicted in Fig. \ref{} a). The diverse set of conformations obtained in the melt yields a single blob in the sketch-map space. The rich conformational space does not allow to identify distinct clusters associated with certain conformations indicating a smooth distribution. However, a trend within the projected blob is observed when analyzing the positioning of selected chain structures, as shown for a few examples at the bottom of Fig. \ref{}: The majority of the sPS chains associated with an mean square end-to-end distance close to the observed average are mapped onto the blob center (example (2)). The second sketch-map axis $a_2$ correlates with the extension of the chain, i.e. elongated chain are mapped to low values of $a_2$ (example (3)) while collapsed chains are mapped to high values of $a_2$ (example (1)). The role of first sketch-map axis $a_1$ is more ambiguous. While high values of $a_1$ can be associated with an u-shaped chains (example (4), lower values of $a_1$ can not be associated with specific shapes of the sPS chains.  

The free energy landscape for the KG model displayed in Fig. \ref{} b) clearly differs from the free energy landscape obtained for the Fritz model. The overall shape of the obtained blob is more condensed and has an elliptic shape. The intersection between the two free energy distributions is small, as KG chains are mapped to lower values for the sketch-map axis $a_1$ compared with the Fritz model.

The morphed structures yield sketch-map free energy landscapes that vary in shape. While both morphing schemes yield distinct results, a shift of the obtained blobs towards higher values for the second sketch-map axis $a_2$ is observed for higher values of the morphing scale $s$ for both schemes. The best match with the Fritz model is visually obtained for scheme A and $s=2$. On the other hand, deploying morphing scheme B with $s=2$ has no significant impact on the free energy landscape, i.e. the results for the original KG model are reproduced. Example structures (5)-(8) illustrate the impact of the morphing deploying different morphing models. While example (5) displays an original KG structure, examples (6)-(8) illustrate corresponding morphed structures. Deploying scheme A and $s=2$ (example (6)) has visually only a minor impact on the overall chain structure but the resulting modifications are sufficient to reposition it to an area associated with a statistical weight in terms of the free energy landscape obtained for the Fritz model. Applying scheme A and $s=6$ (example (7) yields a smooth chain structure that is mapped to an area associated with low statistical weight. Morphing scheme B and $s=4$ (example (8)) results in an obviously false structure as indicated by an overstretched bond that gets mapped to an area not covered by Fritz distribution.


\begin{figure}[h!]
  \centering
      \includegraphics[width=1.1\textwidth]{./Figures/morphing/sPS/free_energy_with_snapshots.pdf}
  \caption{Free energy landscapes in sketch-map coordinates for the coarse-grained Fritz model, KG model and morphed structures deploying both morphing schemes A and B for $s= 2,4,6$. }
  \label{FIG:morph_sps_free_energy}
\end{figure}

Table \ref{} displays the Jenson-Shannon divergences computed for the free energy distributions of the morphed structures and the reference Fritz model. The reported Jenson-Shannon divergences underpin the results obtained from visually inspecting Fig. \ref{}, i.e. the lowest value is obtained for morphing scheme A and $s=2$.

\begin{table}[h!]
\begin{tabular}{ c|c|c } 
 & scheme A & scheme B \\
\hline
s = 2 & 0.436 & 4.654 \\ 
s = 4 & 1.953 & 0.646 \\ 
s = 6 & 3.589 & 3.495  
\caption{ Jenson-Shannon divergence. KG: 4.661 }
\label{TAB:sPS_chem_trans}
\end{tabular}
\end{table}

\subsubsection{Backmapping}

The motivation to morph local statistics stems from the idea to reduce artifacts upon backmapping due to the imperfection of coarse-grained structures. Therefore, the impact of the morphing on the quality on sPS melts backmapped to the original resolution of the moderately coarse-grained Fritz model is investigated. To this end, DBM is trained on 10 snapshots obtained with the Fritz model to reintroduce missing degrees of freedom. Specifically, each coarse-grained bead at the KG resolution maps to three Fritz beads of type A and three Fritz beads of type B. DBM is trained using regularization $\mathcal{C}^{(1)}_{\text{pot}}$ based on the forcefield of Fritz \emph{et al.} After training, backmapping is performed for coarse-grained Fritz configurations, KG configurations, and morphed KG configurations. Morphed structures are obtained with the best performing morphing model, i.e. schema A and $s=2$. 

Fig. \ref{} displays selected structural distributions for the reference Fritz model and backmapped configurations. The baseline accuracy of DBM is probed by its ability to backmap coarse-grained Fritz configurations. DBM is capable of reproducing bond length distribution with remarkable accuracy, as illustrated exemplary for the A-B bond depicted in Fig. \ref{} a). Distributions for the angles of backmapped structures, shown in Fig \ref{} (b) and (c) are slightly too broad and fail to reproduce the correct height of the main peak. Similar issues are observed for the dihedrals of backmapped structures displayed in Fig \ref{} (d). However, the overall accuracy of intra-molecular structural distributions is satisfactory. The pair correlation function $g(r)$ depicted in Fig. \ref{} (e)-(f) reveals a discrepancy between reference and backmapped structures in terms of distances for nonbonded beads. 

The quality of backmapped structures from the KG model does not significantly differ from the baseline quality. As such, the influence of the morphing on the quality of backmapped structures is neglectable.

\begin{figure}
  \centering
      \includegraphics[width=0.8\textwidth]{./Figures/morphing/sPS/dbm_morphed.pdf}
  \caption{Canonical distribution for configurations backmapped to the Fritz resolution. (a) bond A-B, (b) angle A-B-A, (c) angle B-A-B, (d) dihedrals A-B-A-B, (e) radial distribution function for nonbonded beads of type A, (f) radial distribution function for nonbonded beads of type B. Backmapping is performed for coarse-grained Fritz configurations (blue), KG configurations (red), and morphed KG configurations (green). Morphed structures are obtained with the best performing morphing model, i.e. schema A and $s=2$. }
  \label{FIG:TET_morphgibbs}
\end{figure}

\subsection{Discussion}

Kuhn scale matched KG sPS melts display similar large-scale characteristics as the higher resolution and solely-structure based model by Fritz et. al. However, Kuhn scale matching neglects local features below the Kuhn scale. As such, local structural distributions of both models differ, which is demonstrated by coarse-graining of the melt structures obtained with the Fritz model onto the KG resolution. In order to correct local discrepancies of KG structures, DBM is deployed to morph local features up to a certain scale. To this end, DBM is trained to reinsert local features learned from more faithful representations obtained with the Fritz model. 

Two different morphing schemes A and B are applied for three different morphing scales, i.e. $s = 2,4,6$. While DBM has no significant impact on large-scale characteristics, such as the mean square end-to-end distance, it is able to correct local structural features such that they resemble the distributions of the Fritz model. The best performing morphing model for scheme A is observed for $s=2$ and for scheme B for $s=4$. Note that scheme B introduces stronger constraints on the local features, since the original KG structure is deployed as an initial structure. Therefore, scheme B with $s=2$ has no significant impact and leaves local features of the KG structures unchanged. Large values for the morphing scale, i.e. $s=6$, allow to recover the distribution for the angles and pair correlation of the Fritz model but fail to capture the correct distribution for the bond lengths. In general, larger values for the morphing scale $s$ lead to a more difficult backmapping exercise. The aforementioned results are underpinned by an analysis of the free energy landscapes fasciliated by the sketch-map algorithm. 

While morphing improves the structural fidelity of configurations at the KG resolution, it has no significant impact on the quality of backmapped structures at the Fritz resolution. Specifically, backmapping of unchanged KG configurations yield similar results to the baseline, i.e. backmapping of Fritz structures, presumably due to the limited accuracy of the backmapping scheme.

\section{Martini Model: Tetracosane}

\begin{figure}
  \centering
      \includegraphics[width=0.8\textwidth]{./Figures/morphing/tetracosane/morph_ff_dists.pdf}
  \caption{morphbm}
  \label{FIG:TET_morphbm}
\end{figure}

\begin{figure}
  \centering
      \includegraphics[width=1.1\textwidth]{./Figures/morphing/tetracosane/free_energy_with_snapshots.pdf}
  \caption{SM free energy}
  \label{FIG:TET_morphgibbs}
\end{figure}

\begin{table}[h]
\begin{tabular}{ c|c|c } 
 & scheme A & scheme B \\
\hline
s = 2 & 2.338 & 1.213 \\ 
s = 3 & 2.925 &  1.197 
\caption{ Jenson-Shannon divergence. martini: 2.239 }
\label{TAB:sPS_chem_trans}
\end{tabular}
\end{table}

\begin{figure}
  \centering
      \includegraphics[width=0.8\textwidth]{./Figures/morphing/tetracosane/dbm_morphed.pdf}
  \caption{morphbm}
  \label{FIG:TET_morphbm}
\end{figure}


\section{Discussion}
